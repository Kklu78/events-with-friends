{% extends 'base.html' %}
{% block content %}

<h1>Details</h1>


<h4>{{ event.name }}</h4>
<p hidden >{event.images|dictsort:'width'}</p> 

<div class="row">
    <div class="col s12">
        
        <img class="responsive-img" src="{{event.images.0.url}}" width='100%'>
    </div>
    <div class="center-align">
        {% if in_user_events %}
        <form action="{% url 'remove_event' event.id %}" method='POST'>
            {% csrf_token %}
            <button class="btn">Remove From Saved Events</button>
        </form>
        {% else %}
        <form action="{% url 'add_event' event.id %}" method='POST'>
            {% csrf_token %}
            <button class="btn">Add To Saved Events</button>
        </form>
        {% endif %}
    </div>
    
    {% if event.info %}
    <div class="col s12">
        <div class="card">
            <div class="card-content">
                {% if event.info %}
                <h4>Event Info</h4>
                <p>{{ event.info }}</p>
                {% endif %}
                <br>
                {% if event.pleaseNote %}
                <h6>Please Note</h6>
                <p>{{ event.pleaseNote }}</p>
                {% endif %}

            </div>
        </div>
    </div>        
    {% endif %}
        
    <div class="col s12">
        <div class="card">
            <div class="card-content">
                <h5>Date and Time Info</h5>
                <br>
                <p>Date: {{ event.dates.start.localDate }}</p>
                <p>Time: {{ event.dates.start.localTime }}</p>
                <p>Time Zone: {{ event.dates.timezone }}</p>
                <p>Ticket Status: {{ event.dates.status.code }}</p>
            </div>
        </div>
    </div>

    <div class="col s12">
        <div class="card">
            <div class="card-content">
                <h6>Genre and SubGenre Info</h6>
                <br>
                <p>Name: {{ event.classifications.0.segment.name }}</p>
                <p>Genre: {{ event.classifications.0.genre.name }}</p>
                <p>SubGenre: {{ event.classifications.0.subGenre.name }}</p>
            </div>
        </div>
    </div>


    <div class="col s12">
        <div class="card">
            <div class="card-content">
                <h6>Ticket Limit and Health Check Info</h6>
                <br>
                <p> ticket limit: {{ event.accessibility.ticketLimit }}</p>
                <p> Summary: {{ event.ticketing.healthCheck.summary }}</p>
                <p> Description: {{ event.ticketing.healthCheck.description }}</p>
            </div>
        </div>
    </div>
</div>

<hr />
<label>Comments:</label>
<br>
<div class="col s12">
    <form action="{% url 'add_comment' event.id %}" method="post">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <input type="submit" class="btn" value="Add Comment">
      </form>
</div>
<div class="row">
{% for comment in comments %}
<div class="col s10">
    <p>{{comment.user}} commented on {{comment.created_date}}</p>        
    <p>{{comment.content}} </p>        
</div>

{% if comment.user.id == userprofile %}
    <div class="col s2">
        <form action="{% url 'delete_comment' comment.id event.id  %}" method="post">
            {% csrf_token %}
        <input type="submit" class="btn" value="delete">
        </form>
    </div>
{% endif %}
    
{% endfor %}
</div>
{% endblock %}